\section{Analysis of the measure change}
\label{sec:measure-change}

We recall some notation and the lemma we wish to prove. Recall that $\vD_1, \vD_2, \ldots$ are i.i.d.\ copies of $(D^-, D^+)$ a $\N \times \N$-valued random variable. We assume $\E[D^-] = \E[D^+]$ and call this quantity $\mu$. We will use the notation
\begin{equation*}
    \Xi^{\pm}_n = \textstyle \sum_{i=1}^n D^{\pm}_i
    \quad \text{and} \quad
    \Delta_n = \Xi^-_n - \Xi^+_n.
\end{equation*}
We defined
\begin{equation*}
    \cI_n = \{ i \in [n] : D_i^- > 0 \} \quad \text{and} \quad R_n = \abs{\cI_n}.
\end{equation*}
Then $\hat{\vD}_{n, 1}, \ldots, \hat{\vD}_{n, R_n}$ are the elements of $\{\vD_i : u \in \cI_n\}$ in order of discovery according to the eDFS procedure. We will compare this against a sequence of i.i.d.\ $\N \times \N$-valued random variables $\vZ_1, \vZ_2, \ldots$, where for each $i \geq 1$ $\vZ_i$ has law
\begin{equation*}
    \P(Z_i^- = k^-, Z_i^+ = k^+) = \frac{k^-}{\mu} \P(D^- = k^-, D^+ = k^+).
\end{equation*}
Let $\lambda_{\pm} = \E[Z^{\pm}_1]$. We have $\nu_- = \lambda_- - 1$ and under the criticality condition we have $\lambda_+ = 1$. We used the notation
\begin{equation*}
    Y^{\pm}(n) = \sum_{i=1}^n (Z^{\pm}_i - 1).
\end{equation*}
The following theorem asserts the existence of a measure change under conditioning of equal in- and out-degrees and, moreover, it gives the scaling limit of the Radon--Nikodym derivative.

%TODO commented out for includeonly to work
%\measurechange*

We observe that the criticality condition $\lambda_+ = 1$ is, in fact, not necssary for this to hold, and instead prove the following more general result.

\begin{lemma}
    \label{lem:measure-change-no-crit}
    Define the centered random walks
    \begin{equation*}
        V^{\pm}(n) = \sum_{i=1}^n (Z^{\pm}_i - \lambda_{\pm}).
    \end{equation*}
    Then using the notation of \cref{thm:measure-change},
    \begin{align*}
        &\left( 
            \Phi(n, \floor{T n^{2/3}}),
            \left(
                n^{-1/3} V^-\left( \floor{n^{2/3} t} \right),
                n^{-1/3} V^+\left( \floor{n^{2/3} t} \right)
            \right)_{t \in [0, T]}
        \right) \\
        & \hspace{23em} \todist \left( 
            \Phi(T),
            (\sigma_- W^-_t, \sigma_+ W^+_t)_{t \in [0, T]}
        \right)
    \end{align*}
    as $n \to \infty$, even in absence of the criticality condition.
\end{lemma}

\cref{thm:measure-change} then follows as a direct corollary of \cref{lem:measure-change-no-crit} by noting that
\begin{equation*}
    \left( 
        Y^-(n), Y^+(n)
     \right) =
    \left( 
        V^-(n) + n \nu_-, V^+(n)
     \right)
\end{equation*}
and using the continuous mapping theorem. The proof of this result is based upon the proof of \cite[Lemma~6.7]{conchon--kerjanStableGraphMetric2020}, but considerably more work is required in order to deal with the asymptotically singular conditioning.

\input{Content/Sections/Measure_change_exact.tex}

\input{Content/Sections/Measure_change_asym.tex}

\subsection{Convergence of the measure change}

We are now ready to prove the main result of this section.

\begin{proof}[Proof of \cref{lem:measure-change-no-crit}]
    The existence of the measure change is covered by \cref{lem:exact-measure-change}. Define
    \begin{equation*}
        \Gamma(n, m) = \exp \left( 
            \frac{1}{\mu n} \sum_{i=0}^m \left( 
                V^-(i) - V^-(m)
             \right)
             - \frac{\sigma_-}{6 \mu^2} \frac{m^3}{n^2}
         \right).
    \end{equation*}
    Then by Donsker's invariance principle,
    \begin{equation*}
        \left( 
            n^{-1/3} V^-(\floor{tn^{2/3}}),
            n^{-1/3} V^+(\floor{tn^{2/3}})
         \right)_{t \geq 0} \todist
         \left( 
             \sigma_- W^-_t,
             \sigma_+ W^+_t
          \right)_{t \geq 0}
    \end{equation*}
    in $\D\left([0, \infty), \R^2\right)$, where $(W^-_t, W^+_t)_{t \geq 0}$ are a pair of correlated standard Brownian motions with correlation $\corr(Z^-_1, Z^+_1)$. We can write
    \begin{align*}
        \frac{1}{n} \sum_{i=0}^{\floor{T n^{2/3}}} V^-(i)
        &= n^{-2/3} \int_0^{\floor{T n^{2/3}} + 1} n^{-1/3} V^-(\floor{u}) \dif u \\
        &= \int_0^{n^{-2/3}(\floor{T n^{2/3} + 1})} n^{-1/3} V^-(\floor{s n^{2/3}}) \dif s.
    \end{align*}
    Thus, by the continuous mapping theorem,
    \begin{align*}
        \frac{1}{n} \sum_{i=0}^{\floor{T n^{2/3}}} \left(V^-(i) - V^-(m) \right)
        &\todist \int_0^T \left(W^-_s - W^-_T \right) \dif s
        = - \int_0^T s \dif W^-_s.
    \end{align*}
    Hence,
    \begin{align*}
        &\left( 
            \Gamma(n, \floor{T n^{2/3}}),
            \left(
                n^{-1/3} V^-(\floor{t n^{2/3}}),
                n^{-1/3} V^+(\floor{t n^{2/3}})
            \right)_{t \in [0, T]}
         \right) \\
         &\hspace{22em} \todist
         \left( 
             \Phi(T), (\sigma_- W^-_t, \sigma_+ W^+_t)_{t \in [0, T]}
          \right)
    \end{align*}
    in $\R \times \D([0, T], \R)$, as $n \to \infty$. Define the event
    \begin{equation*}
        E_m = \left\{ 
            \max_{i=1, \ldots, m} \abs{V^-(i)} \leq m^{1/2 + \epsilon}
            \quad \text{and} \quad
            \max_{i=1, \ldots, m} \abs{V^+(i)} \leq m^{1/2 + \epsilon}
         \right\}
    \end{equation*}
    for $\epsilon \in (0, 1/6)$. By \cref{lem:measure-change-approx}, it is the case that
    \begin{equation*}
        \Phi(n, m) \geq (\Gamma(n, m) + \littleo(1)) \one_{E_m}.
    \end{equation*}
    The processes $(V^{\pm}(n))_{n \geq 0}$ are discrete martingales. Therefore, by Doob's maximal inequality,
    \begin{equation*}
        \P\left(\max_{i=1, \ldots, m} \abs{V^{\pm}(i)} > m^{1/2 + \epsilon}\right)
        \leq \frac{\E[(V^{\pm}(m))^2]}{m^{1 + 2 \epsilon}} = \frac{\sigma_{\pm}^2}{m^{2 \epsilon}} \to 0
    \end{equation*}
    as $m \to \infty$. Thus $\P(E_m) \to 1$ as $m \to \infty$. Hence, we still have that
    \begin{align*}
        &\left( 
            (\Gamma(n, \floor{T n^{2/3}}) + \littleo(1))\one_{E_{\floor{T n^{2/3}}}} ,
            \left(
                n^{-1/3} V^-(\floor{t n^{2/3}}),
                n^{-1/3} V^+(\floor{t n^{2/3}})
            \right)_{t \in [0, T]}
         \right) \\
         & \hspace{22em} \todist
         \left( 
             \Phi(T), (\sigma_- W^-_t, \sigma_+ W^+_t)_{t \in [0, T]}
          \right).
    \end{align*}
    We have $\E[\Phi(T)] = 1$ by a standard stochastic calculus calculation. Therefore, by \cref{lem:sandwiching-lemma}, we get the desired result that
    \begin{align*}
        &\left( 
            \Phi(n, \floor{T n^{2/3}}) ,
            \left(n^{-1/3} V^-(\floor{t n^{2/3}}), n^{-1/3} V^+(\floor{t n^{2/3}}) \right)_{t \in [0, T]}
         \right) \\
        & \hspace{22em} \todist
         \left( 
             \Phi(T), (\sigma_- W^-_t, \sigma_+ W^+_t)_{t \in [0, T]}
          \right),
    \end{align*}
    and that $(\Phi(n, \floor{T n^{2/3}}))_{n \geq 1}$ is a uniformly integrable sequence.
\end{proof}